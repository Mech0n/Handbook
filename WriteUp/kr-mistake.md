---
title: kr_mistake
date: 2020-01-26 20:47:15
tags:
- pwn
- pwnable.kr
---

# pwnable.kr mistake

ç”±äºè‡ªå·±å®åœ¨å¤ªèœäº†ã€‚å†³å®šæ‰¾ä¸€ä¸ªç½‘ç«™ä»å¤´å¼€å§‹åˆ·é¢˜ã€‚ğŸ¤·â€â™‚ï¸

### 0x0 è¡¥å……çŸ¥è¯†

**è¿ç®—ç¬¦ä»é¡¶åˆ°åº•ä»¥é™åºåˆ—å‡ºã€‚**

|                            ä¼˜å…ˆçº§                            | è¿ç®—ç¬¦                                                       | æè¿°                                                         | ç»“åˆæ€§   |
| :----------------------------------------------------------: | :----------------------------------------------------------- | :----------------------------------------------------------- | :------- |
|                              1                               | `++` `--`                                                    | åç¼€è‡ªå¢ä¸è‡ªå‡                                               | ä»å·¦åˆ°å³ |
|                             `()`                             | å‡½æ•°è°ƒç”¨                                                     |                                                              |          |
|                             `[]`                             | æ•°ç»„ä¸‹æ ‡                                                     |                                                              |          |
|                             `.`                              | ç»“æ„ä½“ä¸è”åˆä½“æˆå‘˜è®¿é—®                                       |                                                              |          |
|                             `->`                             | ç»“æ„ä½“ä¸è”åˆä½“æˆå‘˜é€šè¿‡æŒ‡é’ˆè®¿é—®                               |                                                              |          |
|                      `(*type*){*list*}`                      | å¤åˆå­—é¢é‡(C99)                                              |                                                              |          |
|                              2                               | `++` `--`                                                    | å‰ç¼€è‡ªå¢ä¸è‡ªå‡[[æ³¨ 1\]](https://zh.cppreference.com/w/c/language/operator_precedence#cite_note-1) | ä»å³åˆ°å·¦ |
|                           `+` `-`                            | ä¸€å…ƒåŠ ä¸å‡                                                   |                                                              |          |
|                           `!` `~`                            | é€»è¾‘éä¸é€ä½é                                               |                                                              |          |
|                          `(*type*)`                          | ç±»å‹è½¬å‹                                                     |                                                              |          |
|                             `*`                              | é—´æ¥ï¼ˆè§£å¼•ç”¨ï¼‰                                               |                                                              |          |
|                             `&`                              | å–å€                                                         |                                                              |          |
|                           `sizeof`                           | å–å¤§å°[[æ³¨ 2\]](https://zh.cppreference.com/w/c/language/operator_precedence#cite_note-2) |                                                              |          |
|                          `_Alignof`                          | å¯¹é½è¦æ±‚(C11)                                                |                                                              |          |
|                              3                               | `*` `/` `%`                                                  | ä¹˜æ³•ã€é™¤æ³•åŠä½™æ•°                                             | ä»å·¦åˆ°å³ |
|                              4                               | `+` `-`                                                      | åŠ æ³•åŠå‡æ³•                                                   |          |
|                              5                               | `<<` `>>`                                                    | é€ä½å·¦ç§»åŠå³ç§»                                               |          |
|                              6                               | `<` `<=`                                                     | åˆ†åˆ«ä¸º < ä¸ â‰¤ çš„å…³ç³»è¿ç®—ç¬¦                                   |          |
|                           `>` `>=`                           | åˆ†åˆ«ä¸º > ä¸ â‰¥ çš„å…³ç³»è¿ç®—ç¬¦                                   |                                                              |          |
|                              7                               | `==` `!=`                                                    | åˆ†åˆ«ä¸º = ä¸ â‰  å…³ç³»                                           |          |
|                              8                               | `&`                                                          | é€ä½ä¸                                                       |          |
|                              9                               | `^`                                                          | é€ä½å¼‚æˆ–ï¼ˆæ’é™¤æˆ–ï¼‰                                           |          |
|                              10                              | `|`                                                          | é€ä½æˆ–ï¼ˆåŒ…å«æˆ–ï¼‰                                             |          |
|                              11                              | `&&`                                                         | é€»è¾‘ä¸                                                       |          |
|                              12                              | `||`                                                         | é€»è¾‘æˆ–                                                       |          |
|                              13                              | `?:`                                                         | ä¸‰å…ƒæ¡ä»¶[[æ³¨ 3\]](https://zh.cppreference.com/w/c/language/operator_precedence#cite_note-3) | ä»å³åˆ°å·¦ |
| 14[[æ³¨ 4\]](https://zh.cppreference.com/w/c/language/operator_precedence#cite_note-4) | `=`                                                          | ç®€å•èµ‹å€¼                                                     |          |
|                          `+=` `-=`                           | ä»¥å’ŒåŠå·®èµ‹å€¼                                                 |                                                              |          |
|                        `*=` `/=` `%=`                        | ä»¥ç§¯ã€å•†åŠä½™æ•°èµ‹å€¼                                           |                                                              |          |
|                         `<<=` `>>=`                          | ä»¥é€ä½å·¦ç§»åŠå³ç§»èµ‹å€¼                                         |                                                              |          |
|                        `&=` `^=` `|=`                        | ä»¥é€ä½ä¸ã€å¼‚æˆ–åŠæˆ–èµ‹å€¼                                       |                                                              |          |
|                              15                              | `,`                                                          | é€—å·                                                         | ä»å·¦åˆ°å³ |

### 0x1 åˆ†æ

è¿™é“é¢˜ç»™äº†`hint`å’Œcæ–‡ä»¶ã€‚

ç›´æ¥çœ‹å§ã€‚

`hint :  operator priority`.

```c
#include <stdio.h>
#include <fcntl.h>

#define PW_LEN 10
#define XORKEY 1

void xor(char* s, int len){
        int i;
        for(i=0; i<len; i++){
                s[i] ^= XORKEY;
        }
}

int main(int argc, char* argv[]){

        int fd;
        if(fd=open("/home/mistake/password",O_RDONLY,0400) < 0){
                printf("can't open password %d\n", fd);
                return 0;
        }

        printf("do not bruteforce...\n");
        sleep(time(0)%20);

        char pw_buf[PW_LEN+1];
        int len;
        if(!(len=read(fd,pw_buf,PW_LEN) > 0)){
                printf("read error\n");
                close(fd);
                return 0;
        }

        char pw_buf2[PW_LEN+1];
        printf("input password : ");
        scanf("%10s", pw_buf2);

        // xor your input
        xor(pw_buf2, 10);

        if(!strncmp(pw_buf, pw_buf2, PW_LEN)){
                printf("Password OK\n");
                system("/bin/cat flag\n");
        }
        else{
                printf("Wrong Password\n");
        }

        close(fd);
        return 0;
}
```

æŒ‰é€»è¾‘æ¥è¯´ã€‚æˆ‘ä»¬å¦‚æœèƒ½å¤ŸæŸ¥çœ‹`password`æ–‡ä»¶æœ€å¥½ä¸è¿‡äº†ã€‚ä½†æ˜¯ã€‚æƒ³çš„ç¾ï¼23333.

ä½†æ˜¯æŒ‰ç…§æš—ç¤ºï¼Œå¯ä»¥å…³æ³¨ä¸€ä¸‹æ“ä½œç¬¦ä¼˜å…ˆçº§é—®é¢˜ã€‚

å˜¿å˜¿ã€‚æ‰¾åˆ°äº†ã€‚çœ‹è¿™å¥ï¼š`fd=open("/home/mistake/password",O_RDONLY,0400) < 0`ã€‚æ¯”è¾ƒè¿ç®—ç¬¦å…ˆäºèµ‹å€¼è¿ç®—ç¬¦ã€‚é‚£ä¹ˆ`fd`å°±æ˜¯`0`äº†ã€‚ä¹Ÿå°±æ˜¯æ ‡å‡†è¾“å…¥`stdin`ã€‚

é—®é¢˜è§£å†³äº†ã€‚

### 0x2 EXP

è¿™é“é¢˜ä¸å¤ªéœ€è¦ä»£ç è§£å†³ã€‚ç¬¬ä¸€æ¬¡è¾“å…¥10ä¸ªå­—ç¬¦ï¼Œç¬¬äºŒæ¬¡è¾“å…¥è¿™10ä¸ªå­—ç¬¦çš„å¼‚æˆ–å°±å¥½ã€‚

`echo 1111111111 0000000000 | ./mistake`





